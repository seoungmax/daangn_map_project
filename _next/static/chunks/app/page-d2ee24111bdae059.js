(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2736:function(e,t,s){Promise.resolve().then(s.bind(s,1847))},1847:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var n=s(7437),a=s(2265),r=s(6840),l=s(9738),o=s.n(l),i=s(9235);function Map(e){let{restaurants:t=[],onRestaurantSelect:s}=e,l=(0,a.useRef)(null),[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)([]),[m,f]=(0,a.useState)([]),[x,p]=(0,a.useState)(null),[g,b]=(0,a.useState)(!1),[v,j]=(0,a.useState)(15),[y,w]=(0,a.useState)(null),[k,F]=(0,a.useState)(null),N=(0,a.useRef)(null),C=(0,a.useCallback)((e,t)=>e?{path:"M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z",fillColor:"#FF6B00",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2,scale:2,anchor:new google.maps.Point(12,22)}:{path:google.maps.SymbolPath.CIRCLE,scale:t>18?6:12,fillColor:t>18?"#FFFFFF":"#FF6B00",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2},[]),E=(0,a.useCallback)(e=>{if(c&&t.length&&N.current){if(m.forEach(e=>e.setMap(null)),e<=15){f([]);return}try{let s=100;e<=16?s=20:e<=17&&(s=50);let n=t.filter(e=>void 0!==e.rank&&e.rank<=s).sort((e,t)=>(e.rank||0)-(t.rank||0)),a=e<=16?8e-4:4e-4,r={};n.forEach(e=>{if(!e.position)return;let t=Math.floor(e.position.lat/a),s=Math.floor(e.position.lng/a),n="".concat(t,"-").concat(s),l=r[n];(!l||(l.rank||999)>(e.rank||999))&&(r[n]=e)});let l=[];Object.values(r).forEach(e=>{if(N.current&&e&&e.position)try{let t=N.current(new google.maps.LatLng(e.position.lat,e.position.lng),e.name,(null==y?void 0:y.id)===e.id);t.setMap(c),l.push(t)}catch(e){console.error("Error creating overlay:",e)}}),f(l)}catch(e){console.error("Error in updateOverlaysBasedOnZoom:",e)}}},[c,t,m,y]),S=(0,a.useCallback)((e,t)=>{if(!c)return;if(k&&k!==t&&k.setIcon(C(!1,v)),k===t){t.setIcon(C(!1,v)),F(null),w(null);return}t.setIcon(C(!0,v)),F(t),w(e),c.panTo(e.position);let n=c.getZoom();void 0!==n&&n<17&&c.setZoom(17),s&&s(e)},[c,k,v,C,s]);return((0,a.useEffect)(()=>{if(!c)return;let e=c.addListener("click",()=>{k&&(k.setIcon(C(!1,v)),F(null),w(null))});return()=>{google.maps.event.removeListener(e)}},[c,k,v,C]),(0,a.useEffect)(()=>{if(!c)return;let e=c.addListener("zoom_changed",()=>{let e=c.getZoom()||15;j(e),N.current&&E(e)});return()=>{google.maps.event.removeListener(e)}},[c,E]),(0,a.useEffect)(()=>{let initMap=async()=>{try{if(console.log("Initializing Google Maps..."),console.log("API Key:","exists"),!l.current)throw Error("Map container not found");let e=new i.aN({apiKey:"AIzaSyDIPggm-niEnUPbVWPAonf3M2Q8h3pRwK0",version:"weekly",libraries:["places"]}),t=await e.load();console.log("Google Maps loaded successfully");let RestaurantOverlay=class RestaurantOverlay extends t.maps.OverlayView{onAdd(){let e=document.createElement("div");e.className="custom-overlay";let t=this.isSelected?"#FF6B00":"#CCCCCC",s=this.isSelected?"bold":"normal";e.style.cssText="\n              position: absolute;\n              background: white;\n              border: 1.5px solid ".concat(t,";\n              border-radius: 6px;\n              padding: 4px 8px;\n              font-size: 12px;\n              font-weight: ").concat(s,";\n              color: #000000;\n              white-space: nowrap;\n              transform: translate(-50%, 120%);\n              box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n              z-index: 1;\n            "),e.textContent=this.name,this.div=e;let n=this.getPanes();null==n||n.overlayLayer.appendChild(e)}draw(){if(!this.div)return;let e=this.getProjection(),t=e.fromLatLngToDivPixel(this.position);t&&(this.div.style.left=t.x+"px",this.div.style.top=t.y+"px")}onRemove(){if(this.div){var e;null===(e=this.div.parentNode)||void 0===e||e.removeChild(this.div),this.div=null}}updateSelected(e){this.isSelected=e,this.div&&(this.div.style.border="1.5px solid ".concat(e?"#FF6B00":"#CCCCCC"),this.div.style.fontWeight=e?"bold":"normal")}constructor(e,t,s=!1){super(),(0,r._)(this,"div",null),(0,r._)(this,"position",void 0),(0,r._)(this,"name",void 0),(0,r._)(this,"isSelected",void 0),this.position=e,this.name=t,this.isSelected=s}};N.current=(e,t,s)=>new RestaurantOverlay(e,t,s);let s={center:{lat:37.503679,lng:127.024293},zoom:15,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1};console.log("Creating map with options:",s),l.current&&(l.current.style.width="100%",l.current.style.height="100%");let n=new t.maps.Map(l.current,s);console.log("Map created successfully"),d(n),b(!0);try{new t.maps.Marker({position:{lat:37.503679,lng:127.024293},map:n,title:"당근마켓",icon:{url:"/company-marker.svg",scaledSize:new t.maps.Size(40,40)}}),console.log("Company marker created successfully")}catch(e){console.error("Error creating company marker:",e)}}catch(e){console.error("Error loading Google Maps:",e),p("지도를 불러오는데 실패했습니다: ".concat(e instanceof Error?e.message:String(e)))}};g||initMap()},[g]),(0,a.useEffect)(()=>{c&&g&&N.current&&E(v)},[c,g,v,E]),(0,a.useEffect)(()=>{if(!c||!t.length)return;console.log("Received restaurants:",t.length),console.log("First restaurant:",t[0]),u.forEach(e=>e.setMap(null)),m.forEach(e=>e.setMap(null));let e=[],s=100;v<=13?s=10:v<=15?s=30:v<=16&&(s=50);let n=t.filter(e=>void 0!==e.rank&&e.rank<=s).sort((e,t)=>(e.rank||0)-(t.rank||0));console.log("Filtered restaurants:",n.length),n.forEach(t=>{if(c)try{var s;let n=1e3-(t.rank||0),a=new google.maps.Marker({position:t.position,map:c,title:"".concat(t.name," (").concat(t.rank,"위)"),label:{text:(null===(s=t.rank)||void 0===s?void 0:s.toString())||"",className:"marker-label",color:"#FFFFFF",fontSize:"14px",fontWeight:"bold"},icon:C((null==y?void 0:y.id)===t.id,v),zIndex:n});a.addListener("click",()=>S(t,a)),e.push(a)}catch(e){console.error("Error creating marker for ".concat(t.name,":"),e)}}),console.log("Added restaurant markers:",e.length),h(e),N.current&&E(v)},[c,t,v,C,S,y,E]),x)?(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded-lg",children:(0,n.jsx)("p",{className:"text-red-500",children:x})}):(0,n.jsxs)("div",{className:"jsx-455b7697fc548559 w-full h-full relative",children:[(0,n.jsx)("div",{ref:l,id:"google-map",style:{width:"100%",height:"100%",position:"absolute",top:0,left:0},className:"jsx-455b7697fc548559 w-full h-full rounded-lg shadow-lg"}),!g&&(0,n.jsx)("div",{className:"jsx-455b7697fc548559 absolute inset-0 flex items-center justify-center bg-white bg-opacity-80",children:(0,n.jsxs)("div",{className:"jsx-455b7697fc548559 text-center",children:[(0,n.jsx)("div",{className:"jsx-455b7697fc548559 animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),(0,n.jsx)("p",{className:"jsx-455b7697fc548559 mt-4 text-gray-600",children:"지도를 불러오는 중..."})]})}),y&&k&&(0,n.jsx)("div",{style:{position:"fixed",bottom:0,left:0,right:0,padding:"0 16px 16px 16px",transform:y?"translateY(0)":"translateY(100%)",zIndex:1e3,maxWidth:"100%",margin:"0 auto",backgroundColor:"white"},className:"jsx-455b7697fc548559 fixed inset-x-0 bottom-0 bg-white rounded-t-2xl shadow-lg transition-transform duration-300 ease-in-out",children:(0,n.jsxs)("div",{className:"jsx-455b7697fc548559 bg-white rounded-2xl shadow p-4 pt-3 pb-6",children:[(0,n.jsx)("div",{className:"jsx-455b7697fc548559 w-12 h-1 bg-gray-300 rounded-full mx-auto mb-3"}),(0,n.jsxs)("div",{className:"jsx-455b7697fc548559 flex items-center mb-2",children:[(0,n.jsx)("div",{style:{minWidth:"24px"},className:"jsx-455b7697fc548559 flex items-center justify-center rounded-full bg-orange-100 w-6 h-6 mr-2",children:(0,n.jsx)("span",{className:"jsx-455b7697fc548559 text-xs font-medium text-black",children:y.rank})}),(0,n.jsx)("h2",{className:"jsx-455b7697fc548559 text-lg font-bold text-black",children:y.name})]}),(0,n.jsx)("div",{className:"jsx-455b7697fc548559 text-sm text-gray-700 mb-2",children:y.address}),(0,n.jsxs)("div",{className:"jsx-455b7697fc548559 flex items-center text-sm mb-2",children:[(0,n.jsx)("span",{style:{color:"#FF6B00"},className:"jsx-455b7697fc548559",children:"★"}),(0,n.jsx)("span",{className:"jsx-455b7697fc548559 ml-1 text-gray-800",children:y.rating.toFixed(1)}),(0,n.jsxs)("span",{className:"jsx-455b7697fc548559 ml-1 text-gray-500",children:["(",y.reviews,")"]})]}),(0,n.jsxs)("div",{className:"jsx-455b7697fc548559 flex items-center justify-between text-sm",children:[(0,n.jsxs)("span",{className:"jsx-455b7697fc548559 text-gray-500",children:["회사와의 거리: ",y.distance.toFixed(1),"km"]}),(0,n.jsx)("a",{href:y.googleMapsUrl,target:"_blank",rel:"noopener noreferrer",className:"jsx-455b7697fc548559 text-sm text-blue-600 underline",children:"Google 지도에서 보기"})]})]})}),(0,n.jsx)(o(),{id:"455b7697fc548559",children:"#google-map{width:100%!important;height:100%!important}"})]})}function Home(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[l,o]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let loadRestaurants=async()=>{try{r(!0),o(null),console.log("Fetching restaurant data...");let e=await fetch("/data/restaurants.json");if(console.log("Response status:",e.status),!e.ok)throw Error("Failed to load restaurant data: ".concat(e.status," ").concat(e.statusText));let s=await e.json();console.log("Loaded restaurants:",s.length),t(s)}catch(e){console.error("Error loading restaurants:",e),o(e instanceof Error?e.message:"맛집 데이터를 불러오는데 실패했습니다.")}finally{r(!1)}};loadRestaurants()},[]),s)?(0,n.jsx)("main",{className:"flex min-h-screen items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"맛집 데이터를 불러오는 중..."})]})}):l?(0,n.jsx)("main",{className:"flex min-h-screen items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center text-red-500",children:[(0,n.jsx)("p",{className:"mb-4",children:l}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600",children:"다시 시도"})]})}):(0,n.jsx)("main",{className:"h-screen",children:(0,n.jsx)(Map,{restaurants:e})})}}},function(e){e.O(0,[655,971,472,744],function(){return e(e.s=2736)}),_N_E=e.O()}]);